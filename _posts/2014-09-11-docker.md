---
layout: post
title: Docker.io
tags: docker.io
permalink: docker
---

## Docker Support Only 64-bit System

### [Docker try it! - Interactive Tutorial](https://www.docker.com/tryit/)

### Install

#### [Install on Debian](https://docs.docker.com/installation/debian/)

```sh
# Debian Jessie 8.0 (64-bit) or unstable packages
$ sudo apt-get update
$ sudo apt-get install docker.io
```

#### [Install on OSX](http://penandpants.com/2014/03/09/docker-via-homebrew/) - [Homebrew-Cask](http://caskroom.io)

```sh
# if virtualbox not installed, install via homebrew cask
$ brew install caskroom/cask/brew-cask
$ brew cask install virtualbox

# install docker with boot2docker
$ brew install docker
$ brew install boot2docker
$ boot2docker init

# start boot2docker
$ boot2docker up
$ $(boot2docker shellinit)
```

### [Run Docker without sudo](https://docs.docker.com/installation/debian/#giving-non-root-access)  

```sh
#debian
$ sudo groupadd docker
$ sudo gpasswd -a ${USER} docker # or sudo adduser ${USER} docker
$ sudo service docker restart
```

### Command Tips:

```sh
$ docker images --tree #list images in tree structure ('--tree' is deprecated)
$ docker ps -a #List all containers
$ docker ps -l #List lastest containers
$ docker ps -q #List containers display on IDs (quiet)
```

### Command by yourself in containers - [Working with Containers](https://docs.docker.com/userguide/usingdocker/)

```sh
$ docker run -i -t <image> /bin/bash
```

### [How to continue a docker which is exited](http://stackoverflow.com/questions/21928691/how-to-continue-a-docker-which-is-exited)

```sh
docker start `docker ps -q -l` # restart it in the background
docker attach `docker ps -q -l` # reattach the terminal & stdin
```

### [Clean Up - Remove Docker after exited](https://docs.docker.com/reference/run/#clean-up-rm)

```sh
$ docker run --rm <imamge>
```

### [Docker: remove all Exited containers by Filippo Valsorda](https://coderwall.com/p/zguz_w)

```sh
$ sudo docker ps -a | grep Exit | cut -d ' ' -f 1 | xargs sudo docker rm
```

### Fix Repositoryalready being pulled 
```sh
# $ dokcer pull <images>
# Fix Repository debian already being pulled by another client. Waiting.
$ sudo service docker restart
```

### Mount directory to container - [Managing data in containers](https://docs.docker.com/userguide/dockervolumes/) 

```sh
# docker run option
# -v, --volume=[] create a volume
# -v host:container mount host directory to container 
#   ex. -v $PWD:/app , mount current path to /app in container
# -w, --workdir="" Working directory inside the container

$ docker run -v <host_dir_path>:<container_dir_path> -w <workdir_path> <image> <cmd>
```

### Docker daemon on Debian: not start automatically - [Bash Scripting: Wait for wireless connection, execute program](https://bbs.archlinux.org/viewtopic.php?id=51939)

1. write this script and add it into crontab ($ sudo crontab -e)

```sh
#!/bin/bash

Q="0"
while [ $Q = "0" ]; do
   Q=$(ping -c1 www.google.com 2> /dev/null | grep -c google);
done
echo Connected!

sudo service docker restart
```

### Run multiple command in docker

```sh
$ docker exec <image> sh -c ‘<cmd>’
$ docker run <image> bash -c ‘<cmd>’
```

### [Crontab in Docker](http://www.ekito.fr/people/run-a-cron-job-with-docker/)

#### [Crontab with Docker enviorment](https://registry.hub.docker.com/u/draffensperger/postgres-s3-backup/dockerfile/) - [Sample Project](https://github.com/draffensperger/postgres-s3-backup)

Dockerfile

```sh
# Docker env don't pass though cron jobs, you need to save env to file and load it in cron jobs.
# save Docker envoirment to file with command "env > <file>"

# To debug crontab see to run "rsyslogd" and see logs at "/var/log/syslo"
# CMD rsyslogd && && env > /root/env.sh && tail -f /var/log/cron.log

CMD cron && env > /root/env.sh && tail -f /var/log/cron.log
```

cron_task.sh

```sh
env - `cat /root/env.sh` $1
```

crontab

```sh
# always need ot >> to some where to avoid “(CRON) info (No MTA installed, discarding output)” error in the syslog
# http://askubuntu.com/questions/222512/cron-info-no-mta-installed-discarding-output-error-in-the-syslog

* * * * * root crontab_task.sh “<your command>" >> /var/log/cron.log 2>&1
#An empty line is required at the end of this file for a valid cron file.
```


### Dockerfile
1. [Dockerfile Reference](https://docs.docker.com/reference/builder/)
2. [Docker Explained: Using Dockerfiles to Automate Building of Images](https://www.digitalocean.com/community/tutorials/docker-explained-using-dockerfiles-to-automate-building-of-images)
3. [Dockerfile Best Practices](http://crosbymichael.com/dockerfile-best-practices.html)


### My Docker Containers
1. [Docker-python-opencv](https://registry.hub.docker.com/u/ibotdotout/python-opencv/)


### Dokcer Helper Tools::
1. [kitematic- Docker on Mac](https://kitematic.com/)
2. [Dockviz - Visualizing Docker Data](https://github.com/justone/dockviz)
3. [TOP 10 OPEN-SOURCE DOCKER DEVELOPER TOOLS](http://www.centurylinklabs.com/top-10-open-source-docker-developer-tools/)
4. [Vim Syntax for  Dockerfile](https://github.com/ekalinin/Dockerfile.vim)
5. [Fast, isolated development environments using Docker.](http://www.fig.sh)


### Reference::
1. [Docker User Guide](https://docs.docker.com/userguide/)  
2. [Docker Benefits](http://knitatoms.net/2013/12/benefits-of-docker-for-application-deployment/)  
1. [How to Manage your Docker Image](https://developer.basespace.illumina.com/docs/content/documentation/native-apps/manage-docker-image)
3. [15 QUICK DOCKER TIPS](http://www.centurylinklabs.com/15-quick-docker-tips/)
4. [Guidance for Docker Image Authors](http://www.projectatomic.io/docs/docker-image-author-guidance/)
5. [How We Run as a Non-Root Inside Docker Container](http://www.yegor256.com/2014/08/29/docker-non-root.html)
6. [Docker Command Line Doc](http://docs.docker.com/reference/commandline/cli/)
7. [MAKING DOCKER IMAGES SMALLER](http://www.centurylinklabs.com/optimizing-docker-images/?hvid=2b3AmY)
8. [DOCKER DESKTOP](http://blog.docker.com/2013/07/docker-desktop-your-desktop-over-ssh-running-inside-of-a-docker-container/) - [Github](https://github.com/rogaha/docker-desktop)
9. [jenkins-docker-executors](https://registry.hub.docker.com/u/michaelneale/jenkins-docker-executors/dockerfile/)
10. [Docker-in-Docker](https://github.com/jpetazzo/dind)
11. [Clean up after Docker](http://blog.stefanxo.com/2014/02/clean-up-after-docker/)
12. [How to Use Docker on OS X: The Missing Guide](http://viget.com/extend/how-to-use-docker-on-os-x-the-missing-guide)
13. [introduction-to-docker](http://www.slideshare.net/winggundamth/introduction-to-docker-40139950)
14. [docker-workflow-fig-sh](http://www.syncano.com/docker-workflow-fig-sh/)
15. [Docker Exec Tutorial](https://www.youtube.com/watch?v=y-WH02MlIs8)
16. [Docker Cheat Sheet](https://github.com/wsargent/docker-cheat-sheet)
